---
tags: dailies  
date: 2024-12-27
create: 2024-12-27-週五
time: 09:19
create: <% tp.date.now("YYYY-MM-DD-ddd") %>
---
## Log
---
今天重新追蹤了一下，當初紅黑龍虎的籌碼圖是nil的問題是怎麼解決的。因為最後的處理方式沒有被記載到月報和紅黑龍虎的git上，所以讓我這次追蹤找了很久。
實際上是五月時解決的，並且是修改在共用元件上面。

問題的根本原因是：FeedBackPopup這個元件沒有呼叫super.ctor，因此沒有註冊到其父類別的onExit function，所以BasePopup中的SHOWED_POPUPS table沒有被刪除，但實際上已經在cocos2dx中刪除了。
紅黑龍虎、rick負責的森林舞會，在進房的時候都會呼叫`BasePopup:removeAllPopupWhenEnterForeground`，當中會對SHOWED_POPUPS中的物件呼叫removeFromParentAndCleanup，但實際上已經是nil了，因此發生錯誤，使之後的setChipsConfig沒被呼叫到。

![[clipboard6f46ec95dafafdfbd86f268a352e1eb02fb018e9.jpeg]]

能找到這個問題的契機，是看到森林舞會的log吧：
```
9504-27 14:54:53.400 55061 - V BLYLog: --- MainLayer:onExit ---
9604-27 14:54:54.515 55061 - V BLYLog: removeAllPopup by popid: FEEDBACK
```
發現最後吐出的資訊總是是這個。

## Note
---


<< [[<% fileDate = moment(tp.file.title, 'YYYY-MM-DD').subtract(1, 'd').format('YYYY-MM-DD') %>|Yesterday]] | [[<% fileDate = moment(tp.file.title, 'YYYY-MM-DD').add(1, 'd').format('YYYY-MM-DD') %>|Tomorrow]] >>